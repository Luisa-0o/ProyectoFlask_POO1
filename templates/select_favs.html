{% extends "base.html" %}

{% block title %}Selecciona tus categorías{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2>Elige tus 2 categorías favoritas</h2>
  <p class="text-muted">Selecciona exactamente dos categorías para personalizar tu catálogo.</p>

  <form method="POST">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <div class="mb-3">
      {% if categories %}
        <div class="row">
          {% for cat in categories %}
            <div class="col-md-4 mb-2">
              <div class="form-check">
                <input class="form-check-input fav-checkbox" type="checkbox" name="categories" value="{{ cat }}" id="cat_{{ loop.index }}">
                <label class="form-check-label" for="cat_{{ loop.index }}">{{ cat }}</label>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-info">No hay categorías disponibles en el catálogo todavía.</div>
      {% endif %}
    </div>

    <div>
      <button type="submit" class="btn btn-primary" id="saveFavs">Guardar preferencias</button>
      <a href="{{ url_for('catalogo') }}" class="btn btn-secondary">Omitir</a>
    </div>
  </form>

  <script>
    // Forzar seleccionar máximo 2 opcines
    const checkboxes = document.querySelectorAll('.fav-checkbox');
    checkboxes.forof(cb => cb.addEventListener('change', (event) => {
      const checked = Array.from(checkboxes).filter(c => c.checked);
      if (checked.length > 2) {
        // desmarcar la última seleccionada
        event.target.checked = false;
        alert('Selecciona solo 2 categorías.');
      }
    }));
  </script>
</div>
{% endblock %}
